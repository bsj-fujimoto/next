# 開発フロー定義

このドキュメントは、AIアシスタントとユーザー間の対話を通じた開発プロセスを標準化し、再現性を持たせるための開発フローを定義します。

## 基本フロー

### 1. DevBotの起動と待機
- DevBotセッションを起動（`devbot_start`）
- プレビューURLを設定（通常は `http://localhost:3000`）
- ユーザーの指示を `timeout=0` で無限に待機（`devbot_wait`）

### 2. ユーザー指示の受信
- `devbot_wait` からユーザーの指示を受け取る
- 指示内容を解析して、意図と要件を理解する

### 3. タスクの特定と計画
- 指示内容から必要なタスクを特定
- 複数のステップが必要な場合は、`todo_write` でタスクリストを作成
- 各タスクの優先順位と依存関係を整理

### 4. コード実装・修正
- 必要なファイルを読み込んで現状を確認（`read_file`）
- コードベースを検索して関連実装を確認（`codebase_search`）
- 新しいコンポーネントや機能を実装
- 既存コードを修正・リファクタリング
- 必要に応じて新しいファイルを作成

### 5. 品質チェック
- リンターエラーを確認（`read_lints`）
- エラーがあれば修正
- コードの一貫性とベストプラクティスを確認

### 6. 結果の報告
- 実装内容をユーザーに報告
- 変更したファイルと主な変更点を説明
- DevBotでメッセージを送信（`devbot_send`）

### 7. デモンストレーション（必要に応じて）
- ユーザーが要求した場合、DevBotでブラウザ操作を実行
- スクリーンショットを取得して確認（`devbot_execute` - `screenshot`）
- 実際の動作を確認しながら説明

### 8. フィードバックの受信と対応
- ユーザーからのフィードバックを受け取る
- 問題があれば修正
- 追加の要件があれば対応
- `todo_write` でタスクを更新

### 9. コミット（必要に応じて）
- ユーザーが要求した場合、変更をコミット
- 適切なコミットメッセージを作成
- Git操作を実行（`run_terminal_cmd`）

### 10. 次の指示待ち
- `devbot_wait` で次の指示を待機
- ステップ2から繰り返し

## 詳細なワークフロー

### 新機能の実装フロー

```
1. ユーザー指示受信
   ↓
2. 要件の理解とタスク分解
   - todo_write でタスクリスト作成
   ↓
3. 既存コードの確認
   - read_file で関連ファイルを確認
   - codebase_search で類似実装を検索
   ↓
4. 実装
   - 新しいコンポーネント/機能を作成
   - 既存コードを修正
   ↓
5. 品質チェック
   - read_lints でエラー確認
   - 必要に応じて修正
   ↓
6. テスト・確認
   - DevBotで動作確認（必要に応じて）
   ↓
7. 結果報告
   - devbot_send でユーザーに報告
   ↓
8. フィードバック待ち
   - devbot_wait で次の指示を待機
```

### バグ修正フロー

```
1. ユーザーから問題報告
   ↓
2. 問題の再現と原因特定
   - 関連コードを確認
   - エラーログを確認
   ↓
3. 修正の実装
   - 問題の原因を修正
   - 関連する箇所も確認
   ↓
4. テスト
   - 修正が正しく動作するか確認
   - 他の機能に影響がないか確認
   ↓
5. 結果報告
```

### UI/UX改善フロー

```
1. デザイン変更の要求
   ↓
2. 現在のデザインを確認
   - スクリーンショット取得
   - 関連スタイルを確認
   ↓
3. デザインの実装
   - Tailwind CSSクラスを調整
   - 必要に応じてコンポーネントを修正
   ↓
4. プレビューで確認
   - DevBotでスクリーンショット取得
   - ユーザーに確認
   ↓
5. フィードバックに基づく調整
   ↓
6. 最終確認とコミット
```

## 重要な原則

### 1. 段階的な実装
- 一度にすべてを実装せず、段階的に進める
- 各ステップで確認とフィードバックを受ける

### 2. コードの一貫性
- 既存のコードスタイルに合わせる
- 命名規則やディレクトリ構造を統一

### 3. エラーハンドリング
- リンターエラーは必ず確認して修正
- 実行時エラーも可能な限り予測して対処

### 4. ドキュメント化
- 重要な変更はコメントで説明
- 複雑なロジックは説明を追加

### 5. ユーザーとの対話
- 不明な点は推測せず、必要に応じて確認
- 実装内容を分かりやすく説明

### 6. デモンストレーション
- 重要な機能は実際に動作させて確認
- スクリーンショットで視覚的に説明

## よく使うツールとパターン

### ファイル操作
- `read_file`: ファイルの内容を確認
- `write`: 新しいファイルを作成
- `search_replace`: 既存ファイルを編集
- `grep`: 特定のパターンを検索

### コードベース探索
- `codebase_search`: セマンティック検索で関連コードを発見
- `glob_file_search`: ファイル名パターンで検索

### 品質管理
- `read_lints`: リンターエラーを確認
- `run_terminal_cmd`: ビルドやテストを実行

### DevBot操作
- `devbot_start`: セッション開始
- `devbot_wait`: ユーザー指示を待機
- `devbot_send`: メッセージ送信
- `devbot_execute`: ブラウザ操作
- `devbot_screenshot`: スクリーンショット取得

### タスク管理
- `todo_write`: タスクリストの作成・更新
- 複雑なタスクは分解して管理

## 実装例

### コンポーネント実装の例

1. **要件の理解**
   - ユーザー: "ログイン画面を実装して"
   - タスク分解: フォーム、バリデーション、スタイリングなど

2. **既存コードの確認**
   - 既存のログイン関連コードを検索
   - デザインシステムの確認

3. **実装**
   - コンポーネントファイルを作成
   - スタイルを適用
   - 機能を実装

4. **テスト**
   - DevBotで実際に動作確認
   - スクリーンショットで確認

5. **フィードバック対応**
   - ユーザーからの修正要求に対応
   - デザインの調整など

6. **完了**
   - コミット（必要に応じて）
   - 次の指示待ち

## 注意事項

- ユーザーの意図を正確に理解することが最重要
- 推測で進めず、不明な点は確認する
- 一度に大きな変更をせず、段階的に進める
- エラーは必ず確認して修正する
- ユーザーのフィードバックを重視する

