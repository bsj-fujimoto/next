# アバターアイコンとドロップダウンメニュー機能の実装計画

## 機能概要

ダッシュボードのログアウトボタンをアバターアイコンに変更し、クリックするとドロップダウンメニューが表示されるようにします。ドロップダウンメニューには以下の項目を配置します：

1. プロフィール画面へのリンク
2. セッティング画面へのリンク
3. ログアウトボタン

## ユーザーの指示内容

- ダッシュボードのログアウトボタンをアバターアイコンに変更
- アバターアイコンをクリックするとドロップダウンメニューが表示される
- ドロップダウンメニューに以下を配置：
  - プロフィール画面への動線
  - セッティング画面への動線
  - ログアウトボタン

## 非機能要件

### パフォーマンス要件
- ドロップダウンメニューの表示/非表示は即座に反応する（100ms以内）
- アニメーションは滑らかで自然な動き

### アクセシビリティ要件
- WCAG AA準拠
- キーボードナビゲーション対応（Tabキーでフォーカス移動、Enter/Spaceで選択）
- スクリーンリーダー対応（aria-label, aria-expanded, role属性の適切な使用）
- フォーカス管理の適切な実装

### セキュリティ要件
- ログアウト機能は既存の実装を維持
- 認証状態の確認は既存のフックを使用

### ブラウザサポート範囲
- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

### モバイル対応
- タッチデバイスでも操作可能
- レスポンシブデザインに対応

## 依存関係

### 既存のコンポーネント・ライブラリ
- `ItemsPerPageDropdown`コンポーネントの実装を参考にする（ドロップダウンの実装パターン）
- `GlassCard`コンポーネントのスタイルを参考にする（ガラスモーフィズム効果）
- 既存の`logout`関数（`@/utils/auth`）を使用
- 既存の`useRouter`（`next/navigation`）を使用

### 新しいnpmパッケージ
- 不要（既存のライブラリで実装可能）

### APIエンドポイント
- 変更不要（フロントエンドのみの変更）

## エッジケースとエラーハンドリング

### 想定されるエラーケース
1. **ドロップダウンメニューが画面外にはみ出す場合**
   - 解決策: 動的な位置調整（上方向または下方向に表示）

2. **複数のドロップダウンメニューが同時に開く場合**
   - 解決策: 他のドロップダウンメニューを閉じる処理を実装

3. **クリックアウトサイド（メニュー外をクリック）**
   - 解決策: ドキュメント全体のクリックイベントを監視し、メニュー外をクリックしたら閉じる

4. **スクロール時の位置ずれ**
   - 解決策: スクロールイベントを監視し、メニューを閉じる

5. **ウィンドウリサイズ時の位置ずれ**
   - 解決策: リサイズイベントを監視し、メニューを閉じる

### フォールバック処理
- ドロップダウンメニューが表示できない場合は、既存のログアウトボタンを表示（後方互換性）

### ユーザーフィードバック
- ドロップダウンメニューの開閉時に視覚的フィードバック（アニメーション）
- ホバー時の視覚的フィードバック

## 実装方針

### コンポーネント設計
1. **AvatarDropdownコンポーネント**（新規作成）
   - アバターアイコンの表示
   - ドロップダウンメニューの表示/非表示制御
   - メニュー項目のレンダリング

2. **DashboardPageコンポーネント**（既存、修正）
   - ログアウトボタンを`AvatarDropdown`コンポーネントに置き換え

### ページ作成
- `/profile`ページ（新規作成、モック）
- `/settings`ページ（新規作成、モック）

### スタイリング
- 既存のデザインシステムに合わせる（ガラスモーフィズム、グラデーション背景）
- `ItemsPerPageDropdown`と同様のスタイルを適用

## 実装の優先順位

1. **高優先度**
   - アバターアイコンの表示
   - ドロップダウンメニューの基本機能（開閉）
   - ログアウト機能の実装

2. **中優先度**
   - プロフィール・セッティングページへのリンク
   - クリックアウトサイドの処理
   - キーボードナビゲーション

3. **低優先度**
   - アニメーションの最適化
   - スクロール・リサイズ時の処理

