# AIエージェント向け開発ガイド

このドキュメントは、AIエージェントがこのプロジェクトで作業する際に参照すべき情報をまとめています。

## 重要: 最初に確認すべきドキュメント

### 1. 機能開発ガイドライン（必須）

**`docs/guidelines/FEATURE_DEVELOPMENT_GUIDELINE.md`** を必ず確認してください。

このガイドラインには、機能開発の9ステッププロセスが詳しく記載されています：

```
Step 1: 計画を立てる
Step 2: テスト計画を立てる
Step 3: テストコードを実装する
Step 4: 機能を実装する
Step 5: テストコードを実行し、結果を確認する
Step 6: ガイドライン遵守チェックを行いリファクタリングを計画する
Step 7: リファクタリングを実施する
Step 8: 全てのテストを再実行し、結果を確認する
Step 9: 最終的なセルフレビューを行い、PRを作成する
```

### 2. Reactコーディング規約

**`docs/guidelines/REACT_CODING_GUIDELINES.md`** を確認してください。

Reactコンポーネントの設計原則、Hooksの使用規則、パフォーマンス最適化のガイドラインが記載されています。

### 3. Next.jsプロジェクト固有のガイド

Next.jsプロジェクトで作業する場合は、**`next/docs/AGENTS.md`** も確認してください。

## クイックリファレンス

### ブランチ戦略

- 作業は必ず現在のブランチから適切な`feature/xxx/develop`ブランチを作成し、これをベースに進めること
- 全てのステップでは別のブランチ(`feature/xxx/step-xxx`)を作成して進むこと
- ステップ毎に適切なコミットメッセージでコミットしPRを作成すること
- PRは必ず一つ前の工程のブランチに向けて作成すること

### 進行方針

- 全てのステップを完走するまでPRのレビュー結果を待たずに進めること
- 全行程が終わったらユーザーに報告し、次の指示を待つこと

### テスト駆動開発

- Step 2でテスト計画を立てる
- Step 3でテストコードを実装する（テストは全て失敗することを確認）
- Step 4で機能を実装する
- Step 5でテストが全て成功することを確認する

### 必須確認事項

機能実装時（Step 4）には以下を確認：

- ✅ 既存のコンポーネントやライブラリで実装できないかを確認
- ✅ 同様の機能を持つコンポーネントが存在する場合は、共通化や再利用を検討
- ✅ コンポーネントリストに追加（新規コンポーネントの場合）
- ✅ ドキュメントの作成・更新
- ✅ エラーハンドリングの適切な実装
- ✅ アクセシビリティ属性の適切な設定
- ✅ z-indexの適切な設定（Dropdown、ポップアップ、Toastなど）
- ✅ レイアウトの確認（実装後は必ずブラウザで確認）

テスト実行時（Step 3, 5, 8）には以下を確認：

- ✅ テストケースが全て失敗すること（Step 3）
- ✅ テストケースが全て成功すること（Step 5, 8）
- ✅ コンソールエラーがないこと（必須）
- ✅ Dropdownやポップアップが他の要素より前面に表示されること（必須）
- ✅ レイアウトの崩れがないことをスクリーンショットで確認（必須）
- ✅ テストエビデンス（スクリーンショット、動画、テスト結果）をPRに添付（必須）

### リファクタリング

- Step 6でガイドライン遵守チェックを行いリファクタリングを計画する
- Step 7でリファクタリングを実施する
- 同じ違反は同じコミットで修正する
- コンポーネント分割は一つひとつが重い作業となるので、コンポーネント単位でコミットを分ける

### セルフレビュー

Step 9で最終的なセルフレビューを実施：

- ✅ 全てのテストが成功している
- ✅ ガイドラインに準拠している
- ✅ ドキュメントが更新されている
- ✅ コンポーネントリストに追加されている（新規コンポーネントの場合）
- ✅ エラーハンドリングが適切に実装されている
- ✅ アクセシビリティ属性が適切に設定されている
- ✅ パフォーマンスへの悪影響がない
- ✅ セキュリティ上の問題がない
- ✅ コンソールエラーがないことを確認したこと
- ✅ レイアウトの崩れがないことをスクリーンショットで確認したこと
- ✅ Dropdownやポップアップが他の要素より前面に表示されることを確認したこと
- ✅ `npm audit`の結果を確認（critical warningがないことを確認）

## ドキュメント構造

### プロジェクト全体のドキュメント

- `docs/guidelines/` - プロジェクト全体のガイドライン・規約
- `docs/README.md` - ドキュメント整理指針

### Next.jsプロジェクト固有のドキュメント

- `next/docs/components/` - コンポーネントドキュメント
- `next/docs/plans/` - 機能開発計画
- `next/docs/reviews/` - レビュー・レポート
- `next/docs/refactoring/` - リファクタリング計画
- `next/docs/tests/` - テスト計画・結果
- `next/docs/README.md` - Next.jsプロジェクト ドキュメント
- `next/docs/AGENTS.md` - Next.jsプロジェクト AIエージェント向け開発ガイド

## 詳細情報

詳細な手順やルールについては、以下のドキュメントを参照してください：

- **機能開発ガイドライン**: `docs/guidelines/FEATURE_DEVELOPMENT_GUIDELINE.md`
- **Reactコーディング規約**: `docs/guidelines/REACT_CODING_GUIDELINES.md`
- **ドキュメント整理指針**: `docs/README.md`
- **Next.jsプロジェクト ドキュメント**: `next/docs/README.md`
- **Next.jsプロジェクト AIエージェント向けガイド**: `next/docs/AGENTS.md`

## 参考チェックリスト

### パフォーマンス最適化

- [ ] 不要な再レンダリングがないか（React.memo, useMemo, useCallbackの適切な使用）
- [ ] 画像の最適化（Next.js Imageコンポーネントの使用）
- [ ] コード分割の適切な実装（動的インポート）
- [ ] バンドルサイズの確認

### アクセシビリティ

- [ ] 適切なARIA属性の使用（aria-label, aria-describedby, roleなど）
- [ ] キーボードナビゲーションのサポート
- [ ] フォーカス管理の適切な実装
- [ ] 色のコントラスト比の確認（WCAG AA以上）

### セキュリティ

- [ ] XSS対策（dangerouslySetInnerHTMLの使用を最小限に）
- [ ] CSRF対策（API呼び出し時の適切な実装）
- [ ] 認証・認可の適切な実装
- [ ] 機密情報の適切な管理（環境変数の使用）
- [ ] 依存関係の脆弱性確認（npm audit）
